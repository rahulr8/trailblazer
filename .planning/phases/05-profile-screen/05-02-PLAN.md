---
phase: 05-profile-screen
plan: 02
type: execute
wave: 2
depends_on: ["05-01"]
files_modified:
  - app/(modals)/profile.tsx
autonomous: true

must_haves:
  truths:
    - "App Theme section shows 5 color circles with visual selection state"
    - "Data Sync section shows toggles for Apple Health and Google Fit (UI-only)"
    - "Account Management button opens device web browser to placeholder URL"
    - "Privacy Policy link opens device web browser to placeholder URL"
    - "Terms of Use link opens device web browser to placeholder URL"
    - "Sign Out button triggers auth signOut and navigates to login"
    - "Action buttons grid shows Upgrade, Download App, Settings, Reset Challenge in 2x2 layout"
  artifacts:
    - path: "app/(modals)/profile.tsx"
      provides: "Complete profile screen with all sections"
      contains: "WebBrowser.openBrowserAsync"
  key_links:
    - from: "app/(modals)/profile.tsx"
      to: "expo-web-browser"
      via: "import * as WebBrowser"
      pattern: "WebBrowser\\.openBrowserAsync"
    - from: "app/(modals)/profile.tsx"
      to: "firebase/auth"
      via: "signOut(auth)"
      pattern: "signOut\\(auth\\)"
---

<objective>
Complete the profile screen bottom half: app theme color picker, data sync toggles, account/legal links, sign out button, and action buttons grid.

Purpose: Add the remaining wireframe sections and fulfill PROF-03 through PROF-07 requirements (data sync, account management, privacy, terms, sign out).
Output: Fully complete profile.tsx matching the entire wireframe with all requirements satisfied.
</objective>

<execution_context>
@/Users/turbolaunch/.claude/get-shit-done/workflows/execute-plan.md
@/Users/turbolaunch/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/05-profile-screen/05-RESEARCH.md
@.planning/phases/05-profile-screen/05-01-SUMMARY.md
@app/(modals)/profile.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add app theme, data sync, account links, and action buttons</name>
  <files>app/(modals)/profile.tsx</files>
  <action>
Add the remaining sections to profile.tsx below the achievements section (before sign out). Insert these sections in order:

**6. App Theme Section:**
- Section label "App Theme:" (fontSize 16, fontWeight 600, color textPrimary, marginBottom 12)
- Row of 5 color circles using local state `useState<string>('green')` for selected theme
- Colors array: `[{ id: 'green', color: '#22C55E' }, { id: 'blue', color: '#3B82F6' }, { id: 'purple', color: '#8B5CF6' }, { id: 'pink', color: '#EC4899' }, { id: 'orange', color: '#F97316' }]`
- Each circle: Pressable, 44x44, borderRadius full, backgroundColor is the color value
- Selected state: borderWidth 3, borderColor textPrimary, scale slightly (add a white ring effect: wrap in a View with borderWidth 2, borderColor white/background, borderRadius full)
- Unselected: no border adornment
- Layout: flexDirection row, justifyContent space-around, paddingVertical 8

**7. Data Sync & Account Section (card container):**
- Card with cardBackground, cardBorder, borderRadius xl, borderWidth 1, overflow hidden (same as existing menu section pattern)
- Items with dividers between each:

a) Apple Health toggle:
  - Menu item row: Heart icon (color #007AFF, bg #007AFF20), label "Apple Health", Switch on right
  - Local state: `useState<boolean>(false)` for appleHealthEnabled
  - Switch colors: trackColor false=progressTrack, true=primary+"60", thumbColor based on state

b) Google Fit toggle:
  - Menu item row: Activity icon (import from lucide, color #4285F4, bg #4285F420), label "Google Fit", Switch on right
  - Local state: `useState<boolean>(false)` for googleFitEnabled

c) Account Management:
  - Menu item row: Settings icon (color textSecondary, bg textSecondary+"20"), label "Account Management", ChevronRight on right
  - onPress: `WebBrowser.openBrowserAsync('https://example.com/account')`

d) Privacy Policy:
  - Menu item row: Shield icon (import from lucide, color textSecondary, bg textSecondary+"20"), label "Privacy Policy", ChevronRight
  - onPress: `WebBrowser.openBrowserAsync('https://example.com/privacy')`

e) Terms of Use:
  - Menu item row: FileText icon (import from lucide, color textSecondary, bg textSecondary+"20"), label "Terms of Use", ChevronRight
  - onPress: `WebBrowser.openBrowserAsync('https://example.com/terms')`

f) Sign Out:
  - Menu item row: LogOut icon (color danger, bg danger+"20"), label "Sign Out" (color danger)
  - onPress: existing handleSignOut (router.back() then signOut(auth))

**8. Action Buttons Grid (2x2):**
- 2x2 grid using flexDirection row, flexWrap wrap, gap Spacing.md
- Each button: flex 1, minWidth '45%', paddingVertical Spacing.lg, borderRadius xl, borderWidth 1, borderColor cardBorder, backgroundColor cardBackground, alignItems center, justifyContent center
- Buttons:
  a) Upgrade: Crown icon (lucide), "Upgrade" label, onPress Coming Soon toast
  b) Download App: Download icon (lucide), "Download App" label, onPress Coming Soon toast
  c) Settings: Settings icon (lucide), "Settings" label, onPress Coming Soon toast
  d) Reset Challenge: RotateCcw icon (lucide), "Reset Challenge" label, onPress `router.push('/(modals)/reset-challenge')`
- Icon size 24, color primary, marginBottom 8
- Label fontSize 14, fontWeight 500, color textPrimary

**Imports to add:**
- `import * as WebBrowser from 'expo-web-browser'`
- Add to lucide imports: `Activity, Shield, FileText, ChevronRight, Heart, Settings, Crown, Download, RotateCcw, LogOut` (keep existing X, User)
- `import { Switch } from 'react-native'` (add to existing RN imports)
- Keep `useToast` from heroui-native (from Plan 01)

**Remove standalone sign out and reset challenge button** that may exist from Plan 01 placeholder -- these are now integrated into the card section and action buttons grid respectively.

**Add styles** for the new sections to the existing StyleSheet. Reuse existing menuItem, menuIcon, menuLabel, divider styles from Plan 01 (or re-add them if removed).
  </action>
  <verify>
Run `bunx tsc --noEmit` - zero type errors.
Visually verify: Below achievements, screen shows app theme color circles, data sync toggles, account/privacy/terms links, sign out in a card, and 2x2 action buttons at bottom.
Test: Tap Account Management / Privacy Policy / Terms of Use -- each opens in-app browser to placeholder URL.
Test: Tap Sign Out -- modal closes, navigates to login.
Test: Toggle Apple Health / Google Fit switches -- toggle UI state only.
Test: Tap Upgrade / Download App / Settings -- Coming Soon toast.
Test: Tap Reset Challenge -- navigates to reset-challenge modal.
  </verify>
  <done>
Profile screen is fully complete with all wireframe sections. App Theme shows 5 selectable colors. Data Sync has Apple Health and Google Fit UI-only toggles. Account Management, Privacy Policy, Terms of Use open web browser. Sign Out works. Action buttons in 2x2 grid with correct behaviors. All PROF-01 through PROF-07 requirements met. Zero TypeScript errors.
  </done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Complete profile screen matching wireframe with all sections: header, hero identity, coach personality, lifetime stats, achievements, app theme, data sync toggles, account links, sign out, and action buttons</what-built>
  <how-to-verify>
1. Open the app and tap the profile avatar in the TopBar to open the Profile modal
2. Verify top-to-bottom layout:
   - "My Profile" title with subtitle, close (X) button
   - Large avatar, "Sarah Johnson", "Platinum Member", Edit Profile button
   - Coach Personality: 5 emoji options, tap to select (visual highlight)
   - Lifetime stats: 3x2 grid (Total Mins, Longest Streak, Total KMs, Badges, Total Activities, Challenges)
   - Achievements: horizontal scroll row of badge circles
   - App Theme: 5 color circles, tap to select
   - Card section: Apple Health toggle, Google Fit toggle, Account Management, Privacy Policy, Terms of Use, Sign Out
   - Action buttons: 2x2 grid (Upgrade, Download App, Settings, Reset Challenge)
3. Tap "Edit Profile" -- Coming Soon toast appears
4. Tap Account Management -- in-app browser opens
5. Tap Privacy Policy -- in-app browser opens
6. Tap Terms of Use -- in-app browser opens
7. Toggle Apple Health / Google Fit switches -- UI toggles only
8. Tap Upgrade / Download App / Settings -- Coming Soon toast
9. Tap Reset Challenge -- navigates to reset modal
10. Tap Sign Out -- modal closes, returns to login screen
  </how-to-verify>
  <resume-signal>Type "approved" or describe issues</resume-signal>
</task>

</tasks>

<verification>
- `bunx tsc --noEmit` passes with zero errors
- All 8 wireframe sections render in correct order
- External links open via expo-web-browser (not system browser)
- Sign out flow works: modal closes, auth state changes, login screen appears
- All UI-only toggles and selectors work without side effects
- Action buttons trigger correct behaviors (toasts, navigation)
</verification>

<success_criteria>
1. App Theme shows 5 color circles with selection state (PROF-11)
2. Apple Health and Google Fit toggles present and functional UI-only (PROF-03)
3. Account Management opens web browser (PROF-04)
4. Privacy Policy opens web browser (PROF-05)
5. Terms of Use opens web browser (PROF-06)
6. Sign Out triggers auth signOut and navigates to login (PROF-07)
7. Action buttons in 2x2 grid with correct behaviors (PROF-13)
8. Zero TypeScript errors
</success_criteria>

<output>
After completion, create `.planning/phases/05-profile-screen/05-02-SUMMARY.md`
</output>
