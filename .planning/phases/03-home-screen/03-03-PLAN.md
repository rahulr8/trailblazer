---
phase: 03-home-screen
plan: 03
type: execute
wave: 2
depends_on: ["03-01", "03-02"]
files_modified:
  - app/(tabs)/index.tsx
  - components/home/CLAUDE.md
autonomous: true

must_haves:
  truths:
    - "Home screen displays hero swiper at top, stats flip cards below, leaderboard preview at bottom"
    - "All sections flow in a scrollable page with no section headings"
    - "Hero swiper dominates viewport with generous height"
    - "Flip card row is compact relative to hero (two square cards side by side)"
    - "Leaderboard preview appears below flip cards"
    - "Add Activity button remains functional above the content sections"
    - "Pull-to-refresh still works and cycles affirmation text"
    - "TopBar still renders at top with date, affirmation, and avatar"
  artifacts:
    - path: "app/(tabs)/index.tsx"
      provides: "Fully assembled Home screen composing HeroSwiper, StatsFlipCards, and LeaderboardPreview"
      min_lines: 60
    - path: "components/home/CLAUDE.md"
      provides: "Documentation for home components directory"
  key_links:
    - from: "app/(tabs)/index.tsx"
      to: "components/home/HeroSwiper.tsx"
      via: "import and render HeroSwiper component"
      pattern: "import.*HeroSwiper.*from.*components/home"
    - from: "app/(tabs)/index.tsx"
      to: "components/home/StatsFlipCard.tsx"
      via: "import and render StreakFlipCard and NatureScoreFlipCard"
      pattern: "import.*StreakFlipCard.*NatureScoreFlipCard.*from.*components/home"
    - from: "app/(tabs)/index.tsx"
      to: "components/home/LeaderboardPreview.tsx"
      via: "import and render LeaderboardPreview component"
      pattern: "import.*LeaderboardPreview.*from.*components/home"
---

<objective>
Assemble the complete Home screen by composing HeroSwiper, StatsFlipCards, and LeaderboardPreview into the existing `index.tsx`.

Purpose: This plan wires all Phase 3 components into the Home screen, replacing the placeholder content from Phase 2. It also creates the CLAUDE.md documentation for the new `components/home/` directory.

Output: Updated `app/(tabs)/index.tsx` with fully populated Home screen, plus `components/home/CLAUDE.md` documenting all new components.
</objective>

<execution_context>
@/Users/turbolaunch/.claude/get-shit-done/workflows/execute-plan.md
@/Users/turbolaunch/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/03-home-screen/03-CONTEXT.md
@.planning/phases/03-home-screen/03-RESEARCH.md
@.planning/phases/03-home-screen/03-01-SUMMARY.md
@.planning/phases/03-home-screen/03-02-SUMMARY.md
@app/CLAUDE.md
@app/(tabs)/index.tsx
@components/CLAUDE.md
@components/navigation/TopBar.tsx
@contexts/theme-context.tsx
@lib/mock/data.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Rewrite Home screen to compose all Phase 3 components</name>
  <files>app/(tabs)/index.tsx</files>
  <action>
Rewrite `app/(tabs)/index.tsx` to compose the fully populated Home screen.

**Keep from existing code:**
- All existing imports that are still needed (useCallback, useState, Pressable, RefreshControl, ScrollView, Text, View, useToast, Plus, useSafeAreaInsets, TopBar, useTheme, MOCK_AFFIRMATIONS, MOCK_USER)
- `affirmationIndex` state and random initialization
- `refreshing` state and `onRefresh` callback (pull-to-refresh cycles affirmation)
- `handleAddActivity` callback (Coming Soon toast)
- TopBar rendering with affirmation and avatar
- Add Activity button with Plus icon

**Add new imports:**
- `HeroSwiper` from `@/components/home/HeroSwiper`
- `StreakFlipCard`, `NatureScoreFlipCard` from `@/components/home/StatsFlipCard`
- `LeaderboardPreview` from `@/components/home/LeaderboardPreview`

**Screen layout (inside ScrollView, top to bottom):**

1. **TopBar** (existing, unchanged)
   - `<TopBar affirmation={...} avatarUrl={...} />`

2. **Add Activity button** (existing, unchanged)
   - Keep the Pressable with Plus icon and "Add Activity" text
   - Keep Coming Soon toast handler

3. **Hero Swiper section** (NEW)
   - `<View className="mt-4">`
   - `<HeroSwiper motivationText={MOCK_AFFIRMATIONS[affirmationIndex]} />`
   - `</View>`
   - Note: Pass current affirmation as motivationText so pull-to-refresh affects the hero card too

4. **Stats flip cards row** (NEW)
   - `<View className="flex-row gap-3 px-4 mt-4">`
   - `<View className="flex-1"><StreakFlipCard /></View>`
   - `<View className="flex-1"><NatureScoreFlipCard /></View>`
   - `</View>`
   - The `flex-1` on each ensures equal width (two square-ish cards side by side)

5. **Leaderboard preview section** (NEW)
   - `<View className="px-4 mt-6">`
   - `<LeaderboardPreview />`
   - `</View>`

**Remove from existing code:**
- The placeholder `<View className="px-4 gap-4 pt-4">` block with "Home" title and "Your outdoor activity dashboard" subtitle -- this is replaced by the actual content sections

**Spacing pattern (from CONTEXT.md -- no section headings, separated by spacing):**
- mt-4 between Add Activity and Hero Swiper
- mt-4 between Hero Swiper and Stats row (compact, not dominating)
- mt-6 between Stats row and Leaderboard preview (slightly more breathing room)
- paddingBottom: 100 on ScrollView contentContainerStyle (existing, unchanged)

**ScrollView considerations:**
- The HeroSwiper contains a horizontal FlatList. Nested FlatList inside ScrollView works because the inner FlatList is horizontal (different scroll axis). No `nestedScrollEnabled` needed.
  </action>
  <verify>
`npx tsc --noEmit` passes. The file imports all four new components (HeroSwiper, StreakFlipCard, NatureScoreFlipCard, LeaderboardPreview). The placeholder "Home" / "Your outdoor activity dashboard" text is gone. Verify the component renders without errors by checking for runtime TypeScript issues.
  </verify>
  <done>
Home screen displays: TopBar -> Add Activity button -> HeroSwiper (2-card horizontal swiper with dots) -> Stats flip cards row (Streak + Nature Score side by side) -> LeaderboardPreview (Friends/Global toggle, top 5, View All). All content scrollable with pull-to-refresh. No section headings. Placeholder text removed.
  </done>
</task>

<task type="auto">
  <name>Task 2: Create CLAUDE.md for components/home directory</name>
  <files>components/home/CLAUDE.md</files>
  <action>
Create `components/home/CLAUDE.md` documenting all Phase 3 components.

Follow the established pattern from `components/CLAUDE.md` and `components/navigation/` documentation.

Include:

**Directory purpose:** Home screen components for the Trailblazer dashboard.

**Components table:**

| Component | File | Purpose |
|-----------|------|---------|
| FlipCard | FlipCard.tsx | Generic 3D flip card with Reanimated 4 rotateY animation |
| StreakFlipCard | StatsFlipCard.tsx | Streak days front/personal best back, wraps FlipCard |
| NatureScoreFlipCard | StatsFlipCard.tsx | Nature score front/breakdown back, wraps FlipCard |
| HeroSwiper | HeroSwiper.tsx | Horizontal 2-card swiper with gradient motivation + counter cards |
| LeaderboardPreview | LeaderboardPreview.tsx | Friends/Global toggle, top 5 entries, View All to Squad |

**For each component, document:**
- Import path
- Props interface
- Key behavior notes
- Animation details (for FlipCard)

**Key patterns:**
- FlipCard is generic and reusable -- future phases will use it for giveaway, grand prize, wallet cards
- Android perspective ordering: `{ perspective: 1000 }` must be first transform
- HeroSwiper uses FlatList horizontal (not ScrollView) with `snapToInterval`
- LeaderboardPreview navigates via `router.push('/(tabs)/squad')`
- All components consume mock data from `@/lib/mock`
- All components use `useTheme()` for theme-aware colors
  </action>
  <verify>
File exists at `components/home/CLAUDE.md`. Contains documentation for all 4 component files and 5 exported components.
  </verify>
  <done>
CLAUDE.md documents all home screen components with import paths, props, behavior notes, and key patterns for future development.
  </done>
</task>

</tasks>

<verification>
1. `npx tsc --noEmit` passes with zero errors
2. `app/(tabs)/index.tsx` imports and renders HeroSwiper, StreakFlipCard, NatureScoreFlipCard, LeaderboardPreview
3. No placeholder "Home" / "Your outdoor activity dashboard" text remains
4. TopBar and Add Activity button preserved from Phase 2
5. Pull-to-refresh still cycles affirmation text
6. Layout order: TopBar -> Add Activity -> HeroSwiper -> Stats row -> Leaderboard
7. Stats row has two flip cards side by side (flex-row with flex-1 each)
8. `components/home/CLAUDE.md` exists with documentation for all components
9. No section heading text visible (spacing-only separation per CONTEXT.md)
</verification>

<success_criteria>
- Home screen is fully populated with all Phase 3 components
- Hero swiper dominates viewport with 2-card swiper and dot indicators
- Stats flip cards row shows Streak and Nature Score side by side
- Leaderboard preview shows toggle, entries, and View All button
- All existing Phase 2 functionality preserved (TopBar, Add Activity, pull-to-refresh)
- No section headings -- visual separation via spacing only
- Scrollable page with content extending below fold
- CLAUDE.md documents all home components for future Claude sessions
</success_criteria>

<output>
After completion, create `.planning/phases/03-home-screen/03-03-SUMMARY.md`
</output>
