---
phase: 03-home-screen
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - components/home/HeroSwiper.tsx
  - components/home/LeaderboardPreview.tsx
autonomous: true

must_haves:
  truths:
    - "Hero swiper shows 2 cards (motivation + minutes active) in a horizontal scrollable list"
    - "Swiping between hero cards is smooth with paging snap behavior"
    - "Page indicator dots below the swiper track which card is visible"
    - "Motivation card has nature-themed green gradient with white text and refresh button"
    - "Minutes active card shows total minutes formatted clearly"
    - "Leaderboard preview shows Friends/Global pill toggle"
    - "Top 5 entries displayed with rank, avatar, name, and time"
    - "Current user row has accent-tinted background highlight"
    - "View All button is present and will navigate to Your Squad tab"
  artifacts:
    - path: "components/home/HeroSwiper.tsx"
      provides: "Horizontal 2-card swiper with gradient motivation card, counter card, and dot indicators"
      exports: ["HeroSwiper"]
    - path: "components/home/LeaderboardPreview.tsx"
      provides: "Friends/Global toggle leaderboard with top 5 entries and View All button"
      exports: ["LeaderboardPreview"]
  key_links:
    - from: "components/home/HeroSwiper.tsx"
      to: "@/lib/mock"
      via: "import MOCK_HERO_CARDS, MOCK_AFFIRMATIONS for card data"
      pattern: "import.*MOCK_HERO_CARDS.*from.*mock"
    - from: "components/home/HeroSwiper.tsx"
      to: "expo-linear-gradient"
      via: "LinearGradient for motivation card background"
      pattern: "import.*LinearGradient.*from.*expo-linear-gradient"
    - from: "components/home/LeaderboardPreview.tsx"
      to: "@/lib/mock"
      via: "import MOCK_LEADERBOARD_FRIENDS, MOCK_LEADERBOARD_GLOBAL"
      pattern: "import.*MOCK_LEADERBOARD_FRIENDS.*from.*mock"
    - from: "components/home/LeaderboardPreview.tsx"
      to: "expo-router"
      via: "router.push('/(tabs)/squad') for View All navigation"
      pattern: "router\\.push.*squad"
---

<objective>
Build the HeroSwiper and LeaderboardPreview components for the Home screen.

Purpose: These are the two standalone visual sections of the Home screen that don't depend on the FlipCard animation component. Building them in parallel with Plan 01 maximizes execution speed.

Output: Two files in `components/home/` -- `HeroSwiper` (horizontal FlatList with gradient motivation card + counter card + dot indicators) and `LeaderboardPreview` (Friends/Global toggle, ranked entries with avatars, View All button).
</objective>

<execution_context>
@/Users/turbolaunch/.claude/get-shit-done/workflows/execute-plan.md
@/Users/turbolaunch/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/03-home-screen/03-CONTEXT.md
@.planning/phases/03-home-screen/03-RESEARCH.md
@components/CLAUDE.md
@components/navigation/TopBar.tsx
@contexts/theme-context.tsx
@constants/colors.ts
@constants/gradients.ts
@constants/shadows.ts
@lib/mock/types.ts
@lib/mock/data.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create HeroSwiper horizontal card component with gradient and dots</name>
  <files>components/home/HeroSwiper.tsx</files>
  <action>
Create `components/home/HeroSwiper.tsx` exporting a `HeroSwiper` component.

**Props interface:**
```typescript
interface HeroSwiperProps {
  onRefreshMotivation?: () => void;  // Callback when refresh button tapped
  motivationText?: string;            // Override motivation text (optional)
}
```

**FlatList horizontal swiper implementation:**
- Data source: `MOCK_HERO_CARDS` from `@/lib/mock`
- `horizontal={true}`, `pagingEnabled={true}`, `showsHorizontalScrollIndicator={false}`
- `snapToInterval={CARD_WIDTH}` where `CARD_WIDTH = Dimensions.get('window').width - 32` (16px margin each side)
- `decelerationRate="fast"`
- `contentContainerStyle={{ paddingHorizontal: 16 }}`
- `getItemLayout` for performance: `(data, index) => ({ length: CARD_WIDTH, offset: CARD_WIDTH * index, index })`

**Viewability tracking for dots:**
- `const [currentIndex, setCurrentIndex] = useState(0)`
- `viewabilityConfig = { viewAreaCoveragePercentThreshold: 50 }` defined as a `useRef` (stable reference to avoid FlatList re-render warning)
- `onViewableItemsChanged` as `useCallback` that sets `currentIndex` from `viewableItems[0]?.index`
- Both `viewabilityConfig` and `onViewableItemsChanged` must be stable references (useRef/useCallback) to avoid FlatList warnings about changing on re-render

**Card rendering (renderItem):**
For `type === 'motivation'`:
- Outer `View` with `borderRadius: 16`, `overflow: 'hidden'`, `width: CARD_WIDTH`, theme shadow `shadows.md`
- `LinearGradient` from `expo-linear-gradient` filling the card:
  - Use theme `gradients.accent` colors and direction for nature-themed gradient
  - Style: `padding: 24, minHeight: 180, justifyContent: 'space-between'`
- Top-right corner: `RefreshCw` icon from lucide-react-native (size 20, color white, opacity 0.8) inside a small `Pressable`. On press: cycle to random motivation text from `MOCK_AFFIRMATIONS` (maintain local state with `useState` for motivation index, or call `onRefreshMotivation` if provided)
- Center/bottom: motivation text in white, fontSize 20, fontWeight '600', lineHeight 28
- If `motivationText` prop provided, use it; otherwise use `MOCK_HERO_CARDS[0].motivationText`

For `type === 'counter'`:
- Outer `View` with `borderRadius: 16`, `overflow: 'hidden'`, `width: CARD_WIDTH`, theme shadow `shadows.md`
- Background: `colors.cardBackground` with `cardBorder` border
- Padding 24, minHeight 180, centered content
- Large number: format `MOCK_HERO_CARDS[1].minutesActive` as hours+minutes (e.g., "57h 00m") in fontSize 40, fontWeight '800', `colors.textPrimary`
- Subtitle: "Minutes Active" in fontSize 14, `colors.textSecondary`, marginTop 8

**Page indicator dots (below FlatList):**
- Row of dots centered, gap 8, marginTop 12
- Each dot: `View` with width 8, height 8, borderRadius 4
- Active dot: `colors.accent` background
- Inactive dot: `colors.textTertiary` background
- Map over `MOCK_HERO_CARDS` to render dots

**Important:** Do NOT use `pagingEnabled` AND `snapToInterval` together -- choose `snapToInterval` with `decelerationRate="fast"` for consistent cross-platform behavior with custom card widths.
  </action>
  <verify>
`npx tsc --noEmit` passes. `HeroSwiper` is exported as a named export. Verify FlatList has `getItemLayout`, `onViewableItemsChanged`, and `viewabilityConfig` props.
  </verify>
  <done>
HeroSwiper renders a horizontal 2-card FlatList with: (1) gradient motivation card with refresh button and white text, (2) minutes active counter card with formatted time. Page indicator dots below track scroll position. All data from mock layer.
  </done>
</task>

<task type="auto">
  <name>Task 2: Create LeaderboardPreview with Friends/Global toggle and View All</name>
  <files>components/home/LeaderboardPreview.tsx</files>
  <action>
Create `components/home/LeaderboardPreview.tsx` exporting a `LeaderboardPreview` component.

**Props:** None (self-contained, reads mock data directly).

**State:**
- `activeTab: 'friends' | 'global'` with `useState('friends')`

**Friends/Global pill toggle:**
- Container: `View` with `flexDirection: 'row'`, `borderRadius: 24`, `backgroundColor: colors.backgroundSecondary`, `padding: 4`
- Two pill buttons side by side, each a `Pressable`:
  - Active pill: `backgroundColor: colors.accent`, `borderRadius: 20`, `paddingVertical: 8`, `paddingHorizontal: 20`
  - Inactive pill: transparent background, same padding
  - Active text: white, fontWeight '600', fontSize 14
  - Inactive text: `colors.textSecondary`, fontSize 14
- Labels: "Friends" and "Global"

**Leaderboard entries:**
- Data source: `activeTab === 'friends' ? MOCK_LEADERBOARD_FRIENDS : MOCK_LEADERBOARD_GLOBAL`
- Show only first 5 entries: `.slice(0, 5)`
- Each row is a `View` with `flexDirection: 'row'`, `alignItems: 'center'`, `gap: 12`, `padding: 12`, `borderRadius: 12`
- Current user row: `backgroundColor: colors.accent + '15'` (accent with 15 hex opacity = ~8% opacity)
- Non-current user row: transparent background
- Row contents (left to right):
  1. Rank number: width 24, fontSize 16, fontWeight '700', `colors.textSecondary`
  2. Avatar: HeroUI `Avatar` component, `size="sm"`, `alt={entry.displayName}`. Use `<Avatar.Image source={{ uri: entry.avatarUrl }} />` and `<Avatar.Fallback>{initials}</Avatar.Fallback>` pattern (compute initials from displayName first letters)
  3. Name: `flex: 1`, fontSize 15, `colors.textPrimary`, fontWeight '500'
  4. Time: fontSize 14, fontWeight '600', `colors.textSecondary`. Format as hours: `Math.floor(entry.totalTime / 60) + 'h'`

**View All button:**
- `Pressable` at bottom of component
- Text: "View All" in fontSize 15, fontWeight '600', `colors.accent`, textAlign 'center'
- `paddingVertical: 12`
- On press: `router.push('/(tabs)/squad')` from `expo-router`

**Overall layout:**
- Outer `View` with `gap: 8`
- Toggle at top (centered with `alignItems: 'center'`)
- Entries list (no gap between rows -- padding on each row provides spacing)
- View All at bottom

**Imports:**
- `Avatar` from `heroui-native`
- `router` from `expo-router`
- `MOCK_LEADERBOARD_FRIENDS`, `MOCK_LEADERBOARD_GLOBAL` from `@/lib/mock`
- `useTheme` from `@/contexts/theme-context`
  </action>
  <verify>
`npx tsc --noEmit` passes. `LeaderboardPreview` is exported as a named export. Verify it imports from mock data (not hardcoded values), uses HeroUI Avatar, and calls `router.push` for View All.
  </verify>
  <done>
LeaderboardPreview renders Friends/Global pill toggle that switches between two data sets, shows top 5 ranked entries with avatar + name + time, highlights current user row with accent background, and has View All button navigating to `/(tabs)/squad`.
  </done>
</task>

</tasks>

<verification>
1. `npx tsc --noEmit` passes with zero errors
2. Both files exist: `components/home/HeroSwiper.tsx`, `components/home/LeaderboardPreview.tsx`
3. HeroSwiper uses FlatList horizontal with viewability tracking
4. HeroSwiper uses LinearGradient from expo-linear-gradient for motivation card
5. HeroSwiper renders dot indicators tracking current scroll position
6. LeaderboardPreview toggles between friends and global mock data
7. LeaderboardPreview slices to top 5 entries only
8. LeaderboardPreview highlights current user row with accent background
9. LeaderboardPreview has View All button calling router.push to squad tab
10. All data from `@/lib/mock` imports (no hardcoded strings for names/times)
</verification>

<success_criteria>
- HeroSwiper displays 2-card horizontal swiper with smooth snap pagination
- Motivation card has nature-themed gradient background with white text
- Motivation card has refresh button in top-right corner
- Counter card displays formatted total minutes (hours + minutes)
- Dot indicators below swiper reflect current card position
- LeaderboardPreview has Friends/Global pill segmented toggle
- Toggle switches between friends and global leaderboard data
- Top 5 entries show rank, avatar, name, and formatted time
- Current user row visually highlighted with accent background tint
- View All button navigates to Your Squad tab
- All TypeScript strict, no `any`, theme-aware colors
</success_criteria>

<output>
After completion, create `.planning/phases/03-home-screen/03-02-SUMMARY.md`
</output>
